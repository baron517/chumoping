<!DOCTYPE html>
<html lang="en" >
<head>
    <meta charset="UTF-8">
    <title>首页</title>
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0;" name="viewport" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no">

    <link rel="stylesheet" href="css/base.css"/>
    <link rel="stylesheet" href="css/main.css"/>

	<link rel="stylesheet" href="css/swiper.min.css"/>

    <link rel="stylesheet" href="css/animate.css"/>

    <style>


        .shuben-count{position: absolute;left:0;bottom:50px;z-index:10;}
        .shuben-count>div{float: left;font-family: jianti;margin:0 5px;color:#e70014;font-size:50px;position: relative;}
        .shuben-count div div{text-align: center;line-height: 28px;width:100px;position: absolute;right:18px;top:0;}
        .shuben-count div img{display: block;}
        #flame div{z-index:20;}

	   
    </style>

</head>
<body>


<div id="page1" class="page">
<img class="full-img" src="img/1首页页面/位置参考图.jpg" />
    <div class="dianji" id="pageBtn1" style="bottom:60px;left:650px;width:600px;height:150px;"></div>
</div>

<div id="page2" class="page" style="display: none;">
    <img class="full-img" src="img/2游戏说明页面/位置参考图.jpg" />
    <div class="dianji" id="pageBtn2" style="bottom:165px;left:960px;width:300px;height:150px;"></div>

    <div class="dianji" id="pageBtn3" style="bottom:15px;right:10px;width:220px;height:120px;"></div>

</div>

<div id="page3" class="page" style="display: none;">
    <img class="full-img" src="img/3开始游戏页面/素材/法治拼图-3开始游戏BG.png" />
    <img class="zhuye" style="position: absolute;left:20px;top:12px;" src="img/3开始游戏页面/素材/主页按钮.png"/>



    <div  id="flame"></div>

    <div id="zhixiang" style="position: absolute;top:740px;width:264px;text-align: center;left:50%;margin-left:-132px;">
        <img style="position: absolute;bottom:-30px;left:-29px;" src="img/3开始游戏页面/素材/箭头.png"/>
        <img src="img/3开始游戏页面/素材/纸箱.png"/>
    </div>

    <div style="width:232px;height:141px;background: url('img/3开始游戏页面/素材/计时器.png');position: absolute;right:32px;bottom:57px;font-size:70px;color:#555;line-height: 141px;text-align: center;font-family: Arial;">

        <span id="timer"></span>

    </div>

    <div class="shuben-count clearfix">

        <div>
            <img src="img/3开始游戏页面/素材/书本的数量/1.png" />
            <div>0</div>
        </div>
        <div>
            <img src="img/3开始游戏页面/素材/书本的数量/2.png" />
            <div>0</div>
        </div>
        <div>
            <img src="img/3开始游戏页面/素材/书本的数量/3.png" />
            <div>0</div>
        </div>
        <div>
            <img src="img/3开始游戏页面/素材/书本的数量/4.png" />
            <div>0</div>
        </div>
        <div>
            <img src="img/3开始游戏页面/素材/书本的数量/5.png" />
            <div>0</div>
        </div>
        <div>
            <img src="img/3开始游戏页面/素材/书本的数量/6.png" />
            <div>0</div>
        </div>
        <div>
            <img src="img/3开始游戏页面/素材/书本的数量/7.png" />
            <div>0</div>
        </div>

    </div>




</div>

<div id="page4" class="page" style="display: none;">
    <img class="full-img" src="img/4游戏成功页面/位置参考图片.jpg" />
    <div class="dianji zailaiyici" id="page4Btn1" style="bottom:190px;left:670px;width:300px;height:110px;">再来一次</div>
    <div class="dianji zhuye" id="page4Btn2" style="bottom:190px;left:960px;width:300px;height:110px;">返回主页</div>

    <div class="dianji" id="page4Btn3" style="bottom:100px;left:670px;width:580px;height:90px;">点击查看你收集到的书籍</div>
</div>

<div id="page5" class="page" style="display: none;">
    <img class="full-img" src="img/5游戏失败页面/位置参考页面.jpg" />
    <div class="dianji zailaiyici" id="page5Btn1" style="bottom:165px;left:670px;width:300px;height:150px;">再来一次</div>
    <div class="dianji zhuye" id="page5Btn2" style="bottom:165px;left:960px;width:300px;height:150px;">返回主页</div>
</div>

<div id="page6" class="page" style="display: none;">
    <img class="full-img" src="img/6查看书籍页面/位置参考图.jpg" />
    <div class="dianji zhuye" id="page6Btn" style="bottom:0;right:20px;width:180px;height:150px;"></div>
</div>




<script src="js/jquery.js"></script>
<script src="js/common.js"></script>
<script src="js/swiper.min.js"></script>
<script src="js/need.js"></script>

<script>




    var shubenList=["1-1","1-2","1-3","1-4","1-5","1-6","1-7","1-8","1-9","2-1","2-10","2-11","2-12","2-13","2-14","2-2","2-3","2-4","2-5","2-6","2-7","2-8","2-9","3-1","3-2","3-3","4-1","4-10","4-11","4-12","4-13","4-2","4-3","4-4","4-5","4-6","4-7","4-8","4-9","5-1","5-10","5-2","5-3","5-4","5-5","5-6","5-7","5-8","5-9","6-1","6-10","6-2","6-3","6-4","6-5","6-6","6-7","6-8","6-9","7-1","7-2","7-3","7-4","7-5"];

    var wanju=["1 (1)","1 (10)","1 (11)","1 (12)","1 (13)","1 (14)","1 (15)","1 (16)","1 (17)","1 (18)","1 (19)","1 (20)","1 (8)","1 (9)"];

    var allList=shubenList.concat(wanju);

    var xuanzhong=0;
    $("#zhixiang").on("touchstart",function(e)
    {

        xuanzhong=1;

    });

    $("#page4Btn3").click(function()
    {
        $("#page4").hide();
        $("#page6").show();
    });

    var jiezhuCount=0;
    function  isJiezhu(x)
    {

        $("#flame div").each(function()
        {
            var left=parseInt($(this).css("left").split("px")[0]);
            var top=parseInt($(this).css("top").split("px")[0]);

            //console.log("left:"+left+"top:"+top);

            if(Math.abs(top-740)<80&&Math.abs(left-x)<80)
            {

               var imgId= $(this).find("img").attr("data-id");
                if(imgId.indexOf("-")>-1)
                {
                    console.log("接住了");
                    console.log(imgId);
                    var imgIdIndex=imgId.split("-")[0];
                    var textObj=$(".shuben-count div").eq(imgIdIndex-1).find("div");
                    jiezhuCount++;
                    if(jiezhuCount>=78)
                    {
                        $("#page3").hide();
                        $("#page4").show();

                    }
                    textObj.text( parseInt(textObj.text())+1);
                }

                $(this).remove();
            }

        });

    }


    setInterval(function()
    {
        isJiezhu(parseInt($("#zhixiang").css("left").split("px")[0]));

    },100);


    var zuobiao=0;
    $("#zhixiang").on("touchmove",function(e)
    {

        if(xuanzhong)
        {
            var touch = e.originalEvent.touches[0]; //获取第一个触点
            zuobiao = Number(touch.pageX); //页面触点X坐标
            if(zuobiao<1830&&zuobiao>80)
            {
                $("#zhixiang").css("left",zuobiao+"px");
            }


        }

    });

    $("#zhixiang").on("touchend",function(e)
    {

        xuanzhong=0;

    });

    $(".zhuye").click(function()
    {
        $(".page").hide();
        $("#page1").show();
    });

    $("#pageBtn1").click(function()
    {
        $("#page1").hide();
        $("#page2").show();
    });

    $("#pageBtn2").click(function()
    {
        $("#page2").hide();
        $("#page3").show();
        kaishi();
    });

    $("#pageBtn3").click(function()
    {
        $("#page1").show();
        $("#page2").hide();
    });

    function shuffle(arr) {

        arr.sort(function () {

            return Math.random() - 0.5;

        });

        return arr;

    }

    allList=shuffle(allList);



    //书本下降效果
    function Obj(){}  //创建一个对象

    /*为这个对象添加一个具有一个参数的原型方法*/
    Obj.prototype.draw=function(o){
        var speed=0;   //雪花每次下落的数值（10px）
        var startPosLeft=Math.ceil(Math.random()*(1800-100+1)+100);//设置雪花随机的开始x值的大小
        o.style.opacity=(Math.ceil(Math.random()*3)+7)/10;  //设置透明度
        o.style.left=startPosLeft+'px';
        o.style.color="#fff";
        o.style.fontSize=12+Math.ceil(Math.random()*14)+'px';
        setInterval(function(){
            //雪花下落的top值小鱼屏幕的可视区域高时执行下列
            if(speed<document.documentElement.clientHeight){
                o.style.top=speed+'px';
                o.style.left=startPosLeft+Math.ceil(Math.random()*8)+'px';
                speed+=10;
            }
            else{
                o.style.display='none';
            }
        },100);
    }

    var flame=document.getElementById('flame');

    /*使用setInterval定时器每800毫秒创建一个雪花*/
    var suijiImg=0;
    var diaoluoId;




    // 倒计时
    var _ordertimer = null;
    function leftTimer(timeCha) {
        var leftTime = timeCha*1000; //计算剩余的毫秒数
        var days = parseInt(leftTime / 1000 / 60 / 60 / 24, 10); //计算剩余的天数
        var hours = parseInt(leftTime / 1000 / 60 / 60 % 24, 10); //计算剩余的小时
        var minutes = parseInt(leftTime / 1000 / 60 % 60, 10);//计算剩余的分钟
        var seconds = parseInt(leftTime / 1000 % 60, 10);//计算剩余的秒数
        days = checkTime(days);
        hours = checkTime(hours);
        seconds = checkTime(seconds);
        if (days >= 0 || hours >= 0 || minutes >= 0 || seconds >= 0) document.getElementById("timer").innerHTML = "&nbsp;"+minutes + ":" + seconds;
        if (days <= 0 && hours <= 0 && minutes <= 0 && seconds <= 0) {
            window.clearInterval(_ordertimer);
            _ordertimer = null;
        }
    }
    function checkTime(i) { //将0-9的数字前面加上0，例1变为01
        if (i < 10) {
            i = "0" + i;
        }
        return i;
    }


    function kaishi()
    {
        var shijian=166;
        leftTimer(shijian);
        if(_ordertimer)
        {
            clearInterval(_ordertimer);
        }
        _ordertimer=setInterval(function()
        {
            if(shijian!=0)
            {
                shijian--;
                leftTimer(shijian);

            }
            else
            {
                clearInterval(_ordertimer);
            }
        },1000);

        if(diaoluoId)
        {
            clearInterval(diaoluoId);
        }

        diaoluoId=setInterval(function(){
            var odiv=document.createElement('div');  //创建div

            var imgUrl=allList[suijiImg];
            if(imgUrl.indexOf("-")>-1)
            {
                odiv.innerHTML="<img data-id='"+imgUrl+"' src='img/3开始游戏页面/素材/掉落的书籍/"+imgUrl+".png' />";   //div的内容
            }
            else
            {
                odiv.innerHTML="<img data-id='"+imgUrl+"' src='img/3开始游戏页面/素材/掉落的玩具/"+imgUrl+".png'/>";   //div的内容
            }

            suijiImg++;
            //console.log(suijiImg);
            if(suijiImg>=78)
            {
                clearInterval(diaoluoId);
                $("#page3").hide();
                $("#page5").show();
            }

            odiv.style.position='absolute';  //div的绝对定位
            flame.appendChild(odiv);   //把创建好的div放进flame中
            var obj=new Obj();   //创建函数
            obj.draw(odiv);  //执行obj的draw方法
        },2000);


    }





</script>

</body>
</html>